# -*- coding: utf-8 -*-
"""
äº¤äº’å¼ç•Œé¢æ¨¡å—
==============
æä¾›ç”¨æˆ·å‹å¥½çš„äº¤äº’ç•Œé¢
"""

import os
import sys


def clear_screen():
    """æ¸…å±"""
    os.system('cls' if os.name == 'nt' else 'clear')


def print_header():
    """æ‰“å°ç¨‹åºå¤´éƒ¨"""
    print()
    print("â•”" + "â•" * 60 + "â•—")
    print("â•‘" + " " * 12 + "ğŸš„ ä¸­å›½é«˜é“ç½‘ç»œè§„åˆ’ä¸åˆ†æç³»ç»Ÿ ğŸš„" + " " * 12 + "â•‘")
    print("â•‘" + " " * 8 + "China High-Speed Railway Network System" + " " * 8 + "â•‘")
    print("â•š" + "â•" * 60 + "â•")
    print()


def print_menu():
    """æ‰“å°ä¸»èœå•"""
    print("â”Œ" + "â”€" * 40 + "â”")
    print("â”‚" + " " * 14 + "åŠŸ èƒ½ èœ å•" + " " * 14 + "â”‚")
    print("â”œ" + "â”€" * 40 + "â”¤")
    print("â”‚  [1] ğŸ—ºï¸  è·¯å¾„è§„åˆ’ï¼ˆé€‰æ‹©èµ·ç‚¹å’Œç»ˆç‚¹ï¼‰   â”‚")
    print("â”‚  [2] ğŸ“Š  ç½‘ç»œæ¢çº½åˆ†æ               â”‚")
    print("â”‚  [3] ğŸ“‹  æŸ¥çœ‹æ‰€æœ‰åŸå¸‚åˆ—è¡¨           â”‚")
    print("â”‚  [4] ğŸ“ˆ  æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡ä¿¡æ¯           â”‚")
    print("â”‚  [5] ğŸ¨  ä»…æ˜¾ç¤ºç½‘ç»œåœ°å›¾             â”‚")
    print("â”‚  [0] ğŸšª  é€€å‡ºç³»ç»Ÿ                   â”‚")
    print("â””" + "â”€" * 40 + "â”˜")
    print()


def print_cities_list(cities, categories):
    """æ‰“å°åŸå¸‚åˆ—è¡¨"""
    print("\n" + "=" * 50)
    print("ğŸ“ å…¨å›½ 34 ä¸ªçœçº§è¡Œæ”¿åŒºä¸­å¿ƒåŸå¸‚")
    print("=" * 50)
    
    for cat, city_list in categories.items():
        matched = [c for c in city_list if c in cities]
        if matched:
            print(f"\nã€{cat}ã€‘({len(matched)}ä¸ª)")
            print("  " + "ã€".join(matched))
    
    print("\n" + "=" * 50)


def select_city(cities, prompt):
    """é€‰æ‹©åŸå¸‚"""
    print(f"\n{prompt}")
    print("è¾“å…¥åŸå¸‚åç§°ï¼Œæˆ–è¾“å…¥æ•°å­—å¿«é€Ÿé€‰æ‹©ï¼š")
    
    # æ˜¾ç¤ºåŸå¸‚åˆ—è¡¨ï¼ˆå¸¦åºå·ï¼‰
    for i, city in enumerate(cities, 1):
        end = "\n" if i % 6 == 0 else "  "
        print(f"[{i:2d}]{city}", end=end)
    
    if len(cities) % 6 != 0:
        print()
    
    while True:
        choice = input("\nè¯·è¾“å…¥: ").strip()
        
        if not choice:
            print("âš ï¸ è¾“å…¥ä¸èƒ½ä¸ºç©ºï¼Œè¯·é‡æ–°è¾“å…¥")
            continue
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºæ•°å­—
        if choice.isdigit():
            idx = int(choice)
            if 1 <= idx <= len(cities):
                return cities[idx - 1]
            else:
                print(f"âš ï¸ åºå·è¶…å‡ºèŒƒå›´ (1-{len(cities)})ï¼Œè¯·é‡æ–°è¾“å…¥")
                continue
        
        # æ£€æŸ¥æ˜¯å¦ä¸ºåŸå¸‚å
        if choice in cities:
            return choice
        
        # æ¨¡ç³ŠåŒ¹é…
        matches = [c for c in cities if choice in c]
        if len(matches) == 1:
            return matches[0]
        elif len(matches) > 1:
            print(f"âš ï¸ æ‰¾åˆ°å¤šä¸ªåŒ¹é…: {', '.join(matches)}ï¼Œè¯·æ›´ç²¾ç¡®è¾“å…¥")
        else:
            print(f"âš ï¸ æœªæ‰¾åˆ°åŸå¸‚ '{choice}'ï¼Œè¯·é‡æ–°è¾“å…¥")


def print_path_result(result):
    """æ‰“å°è·¯å¾„è§„åˆ’ç»“æœ"""
    print("\n" + "=" * 60)
    print(f"ğŸš„ è·¯å¾„è§„åˆ’ç»“æœï¼š{result['start']} â†’ {result['end']}")
    print("=" * 60)
    
    # æ–¹æ¡ˆA
    print("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("â”‚  â±ï¸  ã€æ–¹æ¡ˆAã€‘æ—¶é—´æœ€çŸ­                                   â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    
    if result['time_path']:
        path_str = " â†’ ".join(result['time_path'])
        print(f"â”‚  è·¯çº¿: {path_str}")
        print(f"â”‚  â° æ€»æ—¶é—´: {result['total_time']:.1f} å°æ—¶")
        print(f"â”‚  ğŸ’° æ€»ç¥¨ä»·: {result['time_path_cost']} å…ƒ")
        print(f"â”‚  ğŸš‰ ç»åœç«™: {len(result['time_path'])} ç«™")
    else:
        print(f"â”‚  âŒ {result['time_error']}")
    
    print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    
    # æ–¹æ¡ˆB
    print("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("â”‚  ğŸ’µ ã€æ–¹æ¡ˆBã€‘ç¥¨ä»·æœ€ä½                                    â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    
    if result['cost_path']:
        path_str = " â†’ ".join(result['cost_path'])
        print(f"â”‚  è·¯çº¿: {path_str}")
        print(f"â”‚  ğŸ’° æ€»ç¥¨ä»·: {result['total_cost']} å…ƒ")
        print(f"â”‚  â° æ€»æ—¶é—´: {result['cost_path_time']:.1f} å°æ—¶")
        print(f"â”‚  ğŸš‰ ç»åœç«™: {len(result['cost_path'])} ç«™")
    else:
        print(f"â”‚  âŒ {result['cost_error']}")
    
    print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    
    # å¯¹æ¯”åˆ†æ
    if result['time_path'] and result['cost_path']:
        print("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
        print("â”‚  ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”åˆ†æ                                        â”‚")
        print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
        
        if result['time_path'] == result['cost_path']:
            print("â”‚  âœ¨ ä¸¤æ–¹æ¡ˆè·¯çº¿å®Œå…¨ç›¸åŒï¼Œè¿™å°±æ˜¯æœ€ä¼˜è·¯å¾„ï¼              â”‚")
        else:
            time_diff = result['cost_path_time'] - result['total_time']
            cost_diff = result['time_path_cost'] - result['total_cost']
            
            print(f"â”‚  â€¢ é€‰æ‹©æ–¹æ¡ˆAå¯èŠ‚çœ {time_diff:.1f} å°æ—¶ï¼Œä½†å¤šèŠ± {cost_diff} å…ƒ")
            print(f"â”‚  â€¢ é€‰æ‹©æ–¹æ¡ˆBå¯èŠ‚çœ {cost_diff} å…ƒï¼Œä½†å¤šèŠ± {time_diff:.1f} å°æ—¶")
            
            # ç»™å‡ºå»ºè®®
            if time_diff > 2 and cost_diff < 200:
                print("â”‚  ğŸ’¡ å»ºè®®: æ¨èæ–¹æ¡ˆAï¼Œæ—¶é—´èŠ‚çœæ˜æ˜¾ï¼Œç¥¨ä»·å·®å¼‚ä¸å¤§")
            elif cost_diff > 300 and time_diff < 1:
                print("â”‚  ğŸ’¡ å»ºè®®: æ¨èæ–¹æ¡ˆBï¼Œç¥¨ä»·èŠ‚çœæ˜æ˜¾ï¼Œæ—¶é—´å·®å¼‚ä¸å¤§")
            else:
                print("â”‚  ğŸ’¡ å»ºè®®: è¯·æ ¹æ®ä¸ªäººæ—¶é—´å’Œé¢„ç®—éœ€æ±‚é€‰æ‹©")
        
        print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")


def print_hub_analysis(top_hubs):
    """æ‰“å°æ¢çº½åˆ†æç»“æœ"""
    print("\n" + "=" * 50)
    print("ğŸ† ç½‘ç»œæ¢çº½åˆ†æï¼ˆä»‹æ•°ä¸­å¿ƒæ€§ï¼‰")
    print("=" * 50)
    print("\nä»‹æ•°ä¸­å¿ƒæ€§åæ˜ ä¸€ä¸ªèŠ‚ç‚¹åœ¨ç½‘ç»œä¸­çš„'æ¡¥æ¢'ä½œç”¨")
    print("å¾—åˆ†è¶Šé«˜ï¼Œè¯´æ˜è¯¥åŸå¸‚æ˜¯è¶Šé‡è¦çš„äº¤é€šæ¢çº½\n")
    
    medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', '4ï¸âƒ£', '5ï¸âƒ£']
    
    print("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("â”‚  æ’å    åŸå¸‚        å¾—åˆ†       é‡è¦æ€§     â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    
    max_score = top_hubs[0][1] if top_hubs else 1
    
    for i, (city, score) in enumerate(top_hubs):
        medal = medals[i] if i < len(medals) else f"{i+1}."
        bar_len = int(score / max_score * 15)
        bar = 'â–ˆ' * bar_len + 'â–‘' * (15 - bar_len)
        print(f"â”‚  {medal}     {city:8s}  {score:.4f}    {bar} â”‚")
    
    print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    
    print("\nğŸ’¡ è¯´æ˜: è¿™äº›æ¢çº½åŸå¸‚å‘ç”Ÿæ•…éšœä¼šå¯¹æ•´ä¸ªç½‘ç»œè¿é€šæ€§é€ æˆè¾ƒå¤§å½±å“")


def print_network_stats(stats):
    """æ‰“å°ç½‘ç»œç»Ÿè®¡ä¿¡æ¯"""
    print("\n" + "=" * 50)
    print("ğŸ“ˆ ç½‘ç»œç»Ÿè®¡ä¿¡æ¯")
    print("=" * 50)
    
    print(f"\n  ğŸ™ï¸  åŸå¸‚èŠ‚ç‚¹æ€»æ•°: {stats['node_count']} ä¸ª")
    print(f"  ğŸš„ é«˜é“çº¿è·¯æ€»æ•°: {stats['edge_count']} æ¡")
    print(f"  ğŸ“Š å¹³å‡è¿æ¥åº¦: {stats['avg_degree']:.2f}")
    print(f"  ğŸ† æœ€å¤§è¿æ¥åº¦: {stats['max_degree_city']} ({stats['max_degree']} æ¡çº¿è·¯)")
    
    if stats['is_connected']:
        print(f"  âœ… ç½‘ç»œè¿é€šæ€§: å®Œå…¨è¿é€š")
    else:
        print(f"  âš ï¸ ç½‘ç»œè¿é€šæ€§: å­˜åœ¨å­¤ç«‹åŒºåŸŸ")
    
    print("\n  ğŸ“Œ ç‰¹åˆ«è¯´æ˜:")
    print("     â€¢ åŒ…å«äº¬å°é«˜é“è§„åˆ’çº¿è·¯ï¼ˆç¦å·-å°åŒ—ï¼‰")
    print("     â€¢ åŒ…å«å·è—é“è·¯è§„åˆ’çº¿è·¯")
    print()


def wait_for_key():
    """ç­‰å¾…ç”¨æˆ·æŒ‰é”®"""
    input("\næŒ‰ Enter é”®ç»§ç»­...")
